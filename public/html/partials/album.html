{{ define "album" }}
<style>
  #album-nav h1 {
    font-size: 3rem;
    color: white;
    border-bottom: 0.5px dotted white;
  }

  #album-nav h2 {
    font-size: 1rem;
    transition: all ease-in-out 150ms;
  }
</style>

<div id="album-nav">
  <h1>{{.AlbumDisplayName}}</h1>
  {{ range .AlbumSongs }}
  <h2
    hx-get="/art/{{.Album}}?song={{.FileName}}"
    hx-push-url="/art/{{.Album}}?song={{.FileName}}"
    hx-select="#footer-left, #song-cover"
    hx-trigger="getSong"
    hx-target="#footer-left, #song-cover"
    hx-swap="outerHTML transition:true"
    class="clickable"
    _="
     on load 
         set :search to href of the location of the window 
         if :search includes '{{.Album}}?song={{.FileName}}'
             if #song-cover does not match .{{.Album}}
                log 'no match'
                send select to me
             else
                send styleSelect to me
             end
         end
         wait 200ms
     end 
     on click
        if I do not match .selected
            send select to me
        end
     end
     on styleSelect
        add .selected to me
        wait for reset
        remove .selected from me
     end
     on select 
        send reset to <h2/> in closest parent <div/>
        send getSong to me
        send styleSelect to me
     end
     "
  >
    {{.DisplayName}}
  </h2>

  {{ end }}

  <div
    class="is-flex is-flex-direction-row is-align-self-center"
    hx-select=" #album-nav"
    hx-target=" #album-nav"
    hx-swap="outerHTML"
  >
    {{ if .PrevAlbum }}
    <h3
      id="nav-before"
      class="is-clickable material-symbols-outlined has-text-white is-align-self-center"
      hx-get="/art/{{.PrevAlbum.AlbumName}}?song={{.PrevAlbum.FirstSong}}"
    >
      navigate_before
    </h3>
    {{ end }} {{ if .NextAlbum }}
    <h3
      id="nav-next"
      class="is-clickable material-symbols-outlined has-text-white is-align-self-center"
      hx-get="/art/{{.NextAlbum.AlbumName}}?song={{.NextAlbum.FirstSong}}"
    >
      navigate_next
    </h3>
    {{ end }}
  </div>
</div>
{{ end }}
